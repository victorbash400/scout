Absolutely, Victor. Here's a comprehensive, structured documentation that consolidates everything from the Agent-to-Agent (A2A) protocol page into a single, detailed reference guide:

---

# ğŸ§  Agent-to-Agent (A2A) Protocol â€” Strands Agents Documentation

## ğŸ“˜ Overview

The Agent-to-Agent (A2A) protocol is an open standard designed to enable seamless communication, discovery, and collaboration between AI agents across platforms. Strands Agents natively supports A2A, allowing developers to build distributed, multi-agent systems with ease.

---

## ğŸš€ Use Cases

A2A unlocks powerful capabilities:

- **Multi-Agent Workflows**: Chain specialized agents for complex tasks.
- **Agent Marketplaces**: Discover and integrate agents from various providers.
- **Cross-Platform Integration**: Connect Strands agents with other A2A-compatible systems.
- **Distributed AI Systems**: Architect scalable, decentralized agent networks.

Explore more via:
- [A2A GitHub Organization](https://strandsagents.com/latest/documentation/docs/user-guide/concepts/multi-agent/agent-to-agent/)
- [A2A Python SDK](https://strandsagents.com/latest/documentation/docs/user-guide/concepts/multi-agent/agent-to-agent/)
- [A2A Documentation](https://strandsagents.com/latest/documentation/docs/user-guide/concepts/multi-agent/agent-to-agent/)

---

## ğŸ“¦ Installation

To enable A2A in Strands:

```bash
pip install 'strands-agents[a2a]'
```

This installs the Strands SDK and all A2A dependencies.

---

## ğŸ› ï¸ Creating an A2A Server

### Basic Setup

```python
from strands import Agent
from strands_tools.calculator import calculator
from strands.multiagent.a2a import A2AServer
import logging

logging.basicConfig(level=logging.INFO)

agent = Agent(
    name="Calculator Agent",
    description="Performs basic arithmetic operations.",
    tools=[calculator],
    callback_handler=None
)

server = A2AServer(agent=agent)
server.serve()
```

Supports both `SendMessageRequest` and `SendStreamingMessageRequest`.

---

### Server Configuration Options

| Parameter           | Description |
|---------------------|-------------|
| `agent`             | Strands Agent instance |
| `host`              | Hostname/IP (default: `127.0.0.1`) |
| `port`              | Port (default: `9000`) |
| `version`           | Agent version (default: `0.0.1`) |
| `skills`            | Custom skill list (auto-generated by default) |
| `http_url`          | Public URL for agent access |
| `serve_at_root`     | Serve at root path (default: `False`) |
| `task_store`        | Custom task storage |
| `queue_manager`     | Custom message queue manager |
| `push_config_store` | Push notification config store |
| `push_sender`       | Push notification sender |

---

### Advanced Customization

You can access and modify the underlying FastAPI or Starlette apps:

```python
from strands import Agent
from strands.multiagent.a2a import A2AServer
import uvicorn

agent = Agent(name="My Agent", description="Custom agent", callback_handler=None)
server = A2AServer(agent=agent)

app = server.to_fastapi_app()
app.add_middleware(...)  # Add custom middleware

uvicorn.run(app, host="127.0.0.1", port=9000)
```

---

## ğŸ§© Custom Components

Implement custom interfaces for advanced control:

```python
from a2a.server.tasks import TaskStore, PushNotificationConfigStore, PushNotificationSender
from a2a.server.events import QueueManager

class CustomTaskStore(TaskStore): ...
class CustomQueueManager(QueueManager): ...

agent = Agent(name="My Agent", description="Custom agent", callback_handler=None)

server = A2AServer(
    agent=agent,
    task_store=CustomTaskStore(),
    queue_manager=CustomQueueManager(),
    push_config_store=MyPushConfigStore(),
    push_sender=MyPushSender()
)
```

---

## ğŸ§­ Path-Based Mounting

Deploy behind load balancers or reverse proxies:

```python
agent = Agent(name="Calculator Agent", description="A calculator agent", callback_handler=None)

server = A2AServer(
    agent=agent,
    http_url="http://my-alb.amazonaws.com/calculator"
)

server_root = A2AServer(
    agent=agent,
    http_url="http://my-alb.amazonaws.com/calculator",
    serve_at_root=True
)
```

---

## ğŸ“¡ A2A Client Examples

### Synchronous Client

```python
import asyncio, logging, httpx
from uuid import uuid4
from a2a.client import A2ACardResolver, ClientConfig, ClientFactory
from a2a.types import Message, Part, Role, TextPart

def create_message(text: str, role: Role = Role.user) -> Message:
    return Message(
        kind="message",
        role=role,
        parts=[Part(TextPart(kind="text", text=text))],
        message_id=uuid4().hex
    )

async def send_sync_message(message: str, base_url="http://127.0.0.1:9000"):
    async with httpx.AsyncClient(timeout=300) as client:
        resolver = A2ACardResolver(httpx_client=client, base_url=base_url)
        agent_card = await resolver.get_agent_card()
        factory = ClientFactory(ClientConfig(httpx_client=client, streaming=False))
        client_instance = factory.create(agent_card)
        msg = create_message(text=message)
        async for event in client_instance.send_message(msg):
            print(event)
```

---

### Streaming Client

```python
async def send_streaming_message(message: str, base_url="http://127.0.0.1:9000"):
    async with httpx.AsyncClient(timeout=300) as client:
        resolver = A2ACardResolver(httpx_client=client, base_url=base_url)
        agent_card = await resolver.get_agent_card()
        factory = ClientFactory(ClientConfig(httpx_client=client, streaming=True))
        client_instance = factory.create(agent_card)
        msg = create_message(text=message)
        async for event in client_instance.send_message(msg):
            print(event)
```

---

## ğŸ§° Strands A2A Tool Integration

Install the client tool:

```bash
pip install 'strands-agents-tools[a2a_client]'
```

Use it to auto-discover and interact with agents:

```python
from strands import Agent
from strands_tools.a2a_client import A2AClientToolProvider

provider = A2AClientToolProvider(known_agent_urls=["http://127.0.0.1:9000"])
agent = Agent(tools=provider.tools)

response = agent("pick an agent and make a sample call")
print(response)
```

---

## ğŸ› ï¸ Troubleshooting

- Refer to the [A2A documentation](https://strandsagents.com/latest/documentation/docs/user-guide/concepts/multi-agent/agent-to-agent/) for protocol-level issues.
- Report bugs on the Strands GitHub repository.
- Include error messages and code samples when submitting issues.

